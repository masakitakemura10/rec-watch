# 📖 RecWatch 詳細マニュアル

このドキュメントでは、RecWatchの高度な機能（TUI、高速化モードなど）について詳しく解説します。

---

## 🖥 TUIモード (Interactive)

`v0.6.0` で追加された、ターミナル上で対話的に操作できるモードです。
現在の監視状況、処理待ちキュー、変換履歴をリアルタイムで確認できます。

### 起動方法
```bash
rec-watch tui
```
※ `config.yaml` の `watchDirs` 設定に基づいて監視を開始します。

### 画面の見方
- **監視中 (Monitoring)**: 現在監視しているディレクトリの一覧です。
- **処理待ちキュー (Queue)**:
  - `(Found)`: ファイルが見つかり、書き込み完了を待機している状態。
- **最近の履歴 (Recent History)**:
  - `🚀 Processing`: 変換処理中。
  - `✅ Done`: 変換完了。
  - `❌ Failed`: 変換失敗。

### キー操作
| キー      | 動作                                                                               |
| --------- | ---------------------------------------------------------------------------------- |
| `j` / `↓` | カーソルを下に移動                                                                 |
| `k` / `↑` | カーソルを上に移動                                                                 |
| `Space`   | **QuickLook (プレビュー)** <br> 選択中の動画をmacOSのQuickLookで即座に再生します。 |
| `q`       | 終了                                                                               |

---

## ⚡️ 高速化・変換モード

RecWatchは、用途やPCのスペックに合わせて最適な変換モードを選べます。

### 1. CPU 分割並列モード (`--parallel-split`)
**「画質は落としたくないが、もっと速くしたい」** 人向け。

巨大な動画ファイル（例: 1時間の配信アーカイブ）を、内部で5分ごとのチャンクに分割し、**全CPUコアを使って一斉に並列変換** してから結合します。

- **メリット**: マルチコア性能の高いMac（M1/M2/M3 Pro/Maxなど）で、リニアに速度が向上します。画質はCPUエンコード(`libx264`)なので高品質を維持できます。
- **デメリット**: 5分以下の短い動画では効果がありません（むしろオーバーヘッドで遅くなる可能性があります）。

```bash
# 例: 1時間の動画を爆速で変換
rec-watch convert huge_archive.mp4 --parallel-split
```

### 2. GPU 爆速モード (`--gpu`)
**「とにかく容量を減らして、一瞬で終わらせたい」** 人向け。

macOS 純正のハードウェアエンコーダ (`VideoToolbox` / `h264_videotoolbox`) を直接使用します。CPUをほとんど使わず、専用チップで処理するため非常に高速です。

- **メリット**: 圧倒的な変換速度。マシンのファンが回らないほど低負荷。
- **デメリット**: CPUエンコード(`libx264`)に比べると、同じビットレートでは画質が若干劣る、またはファイルサイズが大きくなる傾向があります。

```bash
# 例: ゲームのプレイ動画をとりあえず軽量化
rec-watch convert gameplay.mov --gpu
```

### 3. 通常モード (デフォルト)
オプションを指定しない場合、標準的な `ffmpeg` (`libx264`) で変換を行います。
画質と圧縮率のバランスが最も良く、汎用的です。

```bash
rec-watch convert input.mov
```

---

## ⚙️ その他のテクニック

### プロファイル機能 (`--profile`)
用途ごとに設定（画質、プリセット）を保存しておき、瞬時に切り替えることができます。
`~/.config/rec-watch/config.yaml` に記述します。

```yaml
profiles:
  youtube:
    crf: 18 # 高画質
    preset: slow
  archive:
    crf: 28 # 低画質・高圧縮
    preset: veryfast
```

使うとき:
```bash
rec-watch convert input.mov --profile youtube
```
